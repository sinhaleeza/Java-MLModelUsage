With the increasing number of functionally similar services deployed over the Internet, QoS (Quality of Service) plays a more and more important role on deciding which component services should be selected to satisfy the quality requirements for a composite service. Although there exist some service composition approaches to select component services with regard to global QoS constraints, none of them facilitates handling global constraints for general flow structures in real-time distributed systems. In this paper, based on a hierarchical Colored Petri Nets, an approach named LOSGC (Local Optimal Selection with Global Constraints) is proposed to address this problem efficiently and effectively. The new approach is applicable to real-time distributed systems with general flow structures, including sequential, while, conditional choice and parallel operations. The global constraints are decomposed into local constraints according to flow structures, and then the distributed local selections are utilized to select optimal services that satisfy local constraints. A case study is performed to show that LOSGC can effectively apply to complex systems. Meanwhile, the results of experimental evaluation indicate that LOSGC can achieve close-to-optimal results with a significant improvement in terms of computation time.