In cloud computing, it is an urgent problem to provide stable composition service which can satisfy the personalized requirements for large scale users. This paper takes several aspects of web service into consideration, including Quality of Service (QoS), user preference and the service relationships and proposes a method based viterbi algorithm to reason out the global optimal solution of web composition service. Result shows our method holds executive efficiency, stability as well as outstanding selecting result.