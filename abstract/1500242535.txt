In this paper we present a hybrid approach for automatic composition of Web services that generates semantic input-output based compositions with optimal end-to-end QoS, minimizing the number of services of the resulting composition. The proposed approach has four main steps: (1) generation of the composition graph for a request; (2) computation of the optimal composition that minimizes a single objective QoS function; (3) multi-step optimizations to reduce the search space by identifying equivalent and dominated services; and (4) hybrid local-global search to extract the optimal QoS with the minimum number of services. An extensive validation with the datasets of the Web Service Challenge 2009-2010 and randomly generated datasets shows that: (1) the combination of local and global optimization is a general and powerful technique to extract optimal compositions in diverse scenarios; and (2) the hybrid strategy performs better than the state-of-the-art, obtaining solutions with less services and optimal QoS.