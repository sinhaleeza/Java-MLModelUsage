Solving general real-life problems requires a set of appropriate services to be composed via planning, scheduled, and then executed. Web service composition is the most difficult aspect and is our focus. In this paper, we describe a new framework for intelligent semantic Web services that supports the planning and scheduling aspects by a combined HTN planner and CSP. The framework covers all of the procedures needed to deal with a user's request, including domain analysis of the request, task flow decisions and CSP creation by the planner, and solving the CSP by a distributed CSP solver