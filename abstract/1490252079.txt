XML mediation for data validation and privacy anonymization of very large complicated XML messages defined in some industry-specific specifications such as HL7 is becoming increasingly important in SOA because a lot of applications depend on various kinds of hard-coded data validation and privacy anonymization functions, which makes it difficult to keep consistency of the functions among the applications in SOA when the schema of the XML messages in the specifications is updated. This paper proposes a uniform rule-based approach to realize the functions as an XML mediation separated from the applications, which makes it easy to maintain consistency of the functions even when they are updated in accord with the changes to the specifications. Therefore, application developers can readily utilize the mediation with many applications in SOA without additional modification to the applications. Our approach allows the developers to define a set of rules that consist of two components: 1) constraint conditions in a conceptual data notation in the XML message, and 2) actions performed only when the conditions are satisfied. In order to make the rules independent from both the implementation-specific data representation and the industry-specific knowledge, we automatically transform the rules into the implementation-specific data representation using two more factors; one is the data mappings from the data notation in the rules to the concrete data representation in the implementation, and the other is the implied data relationships hidden in the rules. It is very important to take into consideration a general way to import the implied knowledge because it often depends on the industry-specific data structure and it is usually given outside of the mediation system.