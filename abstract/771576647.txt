By arranging multiple existing web services into workflows to create value-added services, automatic web service composition has received much attention in service-oriented computing. A large number of methods have been proposed for it although most of them are merely based on the matching of input-output parameters of services. Besides these parameters, some other elements can affect the execution of services and their composition, such as the preconditions and service execution results. In particular, the execution effects of some services are often uncertain because of the complex and dynamically changing application environments in the real world, and this can cause the emergence of nondeterministic choices in the workflows of composite services. However, the previous methods for automatic service composition mainly rely on sequential structures, which make them difficult to take into account uncertain effects during service composition. In this paper, Graphplan is employed and extended to tackle this problem. In order to model services with uncertain effects, we first extend the original form of Graphplan. Then, we propose a novel approach that can introduce branch structures into composite solutions to cope with such uncertainty in the service composition process. Extensive experiments are performed to evaluate and analyze the proposed methodology.