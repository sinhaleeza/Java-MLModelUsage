This paper presents an infrastructure based in virtualization which provides support to intrusion tolerance (Byzantine or malicious faults) for Web Services. The introduced approach makes extensive use of virtualization technology and shared memory in order to tolerate intrusions at a low cost of messages. The intrusion tolerance is typically achieved using state machine replication (SMR). Our approach allows client requests to be performed with a variable number (between f + 1 and 2f + 1) of execution replicas which is different from more classical implementations of SMR. This paper describes the algorithms, presents details of a prototype, testing and a comparative study with the related work in the literature.