"Cloud of Things" (CoT) is a concept that provides smart things' functions as a service and allows them to be used by multiple applications. In the CoT, a single smart thing instance should efficiently host multiple applications, called multi-tenancy. However, since multiple applications may simultaneously access the same smart things, they may contend for uses of the same smart things, which is called resource conflicts. Moreover, smart things inherently form complex dependencies, examples of which are include a group of smart things in a room, a group of smart things owned by a person, etc. Since handling resource conflicts and complex dependencies at an application level is typically ad-hoc and error-prone, it results in exacerbating readability of application codes. To address these issues, we propose a middleware for Cloud of Things called ECO. The ECO middleware manages organizations to handle dependency among/between smart things and virtualizes physical smart things to enable isolation between/among multiple applications using shared smart things yet internally controls smart things's sharing to resolve resource conflicts. Also, it provides consolidation by harmonizing different smart things's execution contexts of multiple applications for efficient utilization of the shared smart things. As a result, ECO middleware facilitates development of multiple applications over heterogeneous smart things with efficient sharing. The ECO middleware is implemented with heterogeneous device frameworks like UPnP, ZigBee, and CoAP over 6LoWPAN. We show that ECO middleware provides efficient sharing controls and access controls with negligible virtualization overhead.