In a typical cloud computing environment, there will always be different kinds of cloud resources and a number of cloud services making use of cloud resources to run on. As we can see, these cloud services usually have different performance traits. Some may be IO-intensive, like those data querying services, while others might demand more CPU cycles, like 3D image processing services. Meanwhile, cloud resources also have different kinds of capabilities such as data processing, IO throughput, 3D image rendering, etc. A simple fact is that allocating a suitable resource will greatly improve the performance of the cloud service, and make the cloud resource itself more efficient as well. So it is important for the providers to allocate cloud resources based on the fitness of performance traits between resources and services. In this paper, we introduce a new cloud resource allocating algorithm, which creates a market for cloud resources and makes the resource agents and service agents bargain in that market. In this way, use is able to be made of the invisible hand behind the market to grantee the efficiency of allocation. The auction model in our algorithm is new to other auction models in that it takes the effectiveness of fitness between resources and services into consideration during the auction procedures. With the idea of fitness introduced, the bargaining process and final price calculation is modified, so that resources and services can not only trade-off between those such as prices, budgets and the required level of QoS, but also on fitness amongst bidders. We study the allocating algorithm in terms of economic efficiency and system performance, and experiments show that the allocation is far more efficient in comparison with the continuous double auction in which the idea of fitness is not introduced.