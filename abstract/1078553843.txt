In this paper, we investigate the combination of configuration and query rewriting for semantic Web service composition. Given a user query and a set of service descriptions, we rely on query rewriting to find services that implement the functionalities expressed in the user query (discovery stage). Then, we use configuration to capture dependencies between services, and to generate a set of composed Web services described as a directed acyclic graph, while maintaining validity with respect to business rules (orchestration stage).Finally, we propose a semantic ranking algorithm to rank results according to user preferences (classification stage).The techniques used in our approach take into account the semantics of concepts utilized to describe the elements (services, business rules, query and user preferences) involved in the composition process. We provide a formal approach and its implementation, together with experiments on Web services from different application domains.