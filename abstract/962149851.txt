The poor performance of WS-security (WSS) processing is often a topic of concern and prevents its wider adoption. We focused on byte-level similarities in WSS messages and implemented a template-based WSS processor. Inside the processor an automaton is employed that matches the incoming messages and extracts signature values and/or encrypted values. WSS operations including XML canonicalization are performed against the extracted values, without costly XML parsing and traversal. This is more than twice as fast as the DOM-based WSS processor and our prior work with a stream-based processor.